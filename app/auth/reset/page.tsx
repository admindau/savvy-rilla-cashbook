"use client"; import { useEffect, useState, FormEvent } from 'react'; import { supabase } from '@/lib/supabaseClient'; export default function ResetPage(){ const [ready,setReady]=useState(false); const [password,setPassword]=useState(''); const [msg,setMsg]=useState<string|null>(null); useEffect(()=>{ if(typeof window!=='undefined'&&window.location.hash){ supabase.auth.exchangeCodeForSession(window.location.hash).finally(()=>setReady(true)); } else setReady(true); },[]); const onSet=async(e:FormEvent)=>{ e.preventDefault(); setMsg(null); const {error}=await supabase.auth.updateUser({ password }); if(error) setMsg(error.message); else { setMsg('Password updated! Redirecting...'); setTimeout(()=>{ location.href='/auth'; },1500); } }; if(!ready) return <div className='min-h-[40vh] grid place-items-center'>Processing linkâ€¦</div>; return (<div className='max-w-md mx-auto card mt-16'><h1 className='text-xl font-semibold mb-2'>Set a new password</h1>{msg && <p className='text-white/80 mb-2'>{msg}</p>}<form onSubmit={onSet} className='space-y-3'><label className='block'><span className='label'>New password</span><input className='input mt-1' type='password' value={password} onChange={e=>setPassword(e.target.value)} required/></label><button className='btn w-full' type='submit'>Update password</button></form></div>); }
