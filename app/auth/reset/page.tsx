"use client";import {useEffect,useState,FormEvent} from 'react';import {supabase} from '@/lib/supabaseClient';export default function R(){const[r,setR]=useState(false);const[p,sp]=useState('');const[m,sm]=useState<string|null>(null);useEffect(()=>{if(typeof window!=='undefined'&&window.location.hash){supabase.auth.exchangeCodeForSession(window.location.hash).finally(()=>setR(true));}else setR(true)},[]); const on=(x:FormEvent)=>{x.preventDefault();sm(null);supabase.auth.updateUser({password:p}).then(({error})=>{if(error)sm(error.message);else{sm('Password updated!'); setTimeout(()=>location.href='/auth',1200);}})}; if(!r) return <div className='p-8'>Processingâ€¦</div>; return <div className='p-8'><h1 className='text-xl font-semibold mb-3'>Set a new password</h1>{m&&<p className='mb-2'>{m}</p>}<form onSubmit={on} className='space-y-2'><input className='border p-2 w-full text-black' type='password' placeholder='New password' value={p} onChange={e=>sp(e.target.value)} required/><button className='border px-3 py-2'>Update password</button></form></div>}
